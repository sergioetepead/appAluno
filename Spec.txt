# ğŸ“± Portal ETEP - EspecificaÃ§Ã£o TÃ©cnica Completa

## ğŸ¯ VersÃ£o Atual: v1.4.3

### ğŸ’  Arquitetura e Tecnologias

**Plataforma Base:**
- Apache Cordova (PhoneGap) para Android
- HTML5 + CSS3 + JavaScript ES6+ vanilla
- InAppBrowser Plugin v6.0.0 para WebViews customizadas
- Git para controle de versÃ£o

**Estrutura de Arquivos:**
```
etep-app/
â”œâ”€â”€ config.xml           # ConfiguraÃ§Ã£o Cordova, plugins, Ã­cones
â”œâ”€â”€ www/                 # App web principal
â”‚   â”œâ”€â”€ index.html       # Interface das 3 telas
â”‚   â”œâ”€â”€ css/index.css    # Estilos responsive + tema ETEP
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ index.js     # App principal (ETEPApp class)
â”‚   â”‚   â”œâ”€â”€ services/    # ServiÃ§os modulares
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js  # AuthService - validaÃ§Ã£o Jacad
â”‚   â”‚   â”‚   â””â”€â”€ portal.js # PortalService - gerenciamento WebView
â”‚   â”‚   â””â”€â”€ utils/       # UtilitÃ¡rios
â”‚   â”‚       â”œâ”€â”€ cpf.js   # CPFUtils - formataÃ§Ã£o/validaÃ§Ã£o
â”‚   â”‚       â””â”€â”€ storage.js # StorageUtils - localStorage
â”‚   â””â”€â”€ version.json     # Single source of truth para versÃµes
â”œâ”€â”€ platforms/           # CÃ³digo nativo gerado (Android)
â””â”€â”€ plugins/            # Plugins Cordova instalados
```

**DependÃªncias:**
- Node.js + npm (ambiente)
- Android SDK + Java JDK 17
- Gradle para builds Android
- Cordova CLI global

---

## ğŸ” Sistema de AutenticaÃ§Ã£o

### Fluxo Principal:
1. **Home**: UsuÃ¡rio digita CPF + Senha
2. **ValidaÃ§Ã£o**: InAppBrowser oculto testa credenciais no Jacad
3. **Sucesso**: Navega para Menu + salva credenciais em memÃ³ria
4. **Portal**: Novo InAppBrowser com auto-login das credenciais salvas

### Classe AuthService (auth.js):
```javascript
// MÃ©todos principais:
validateCredentials(cpf, password) // ValidaÃ§Ã£o oculta via Jacad
saveCredentials(cpf, password)     // Armazena em memÃ³ria
showAuthenticatedBrowser()         // Cria browser com auto-login
isLoggedIn()                      // Verifica autenticaÃ§Ã£o
cleanup()                         // Limpa sessÃ£o
```

**LÃ³gica de ValidaÃ§Ã£o:**
- Browser oculto acessa Jacad
- Preenche CPF/senha automaticamente
- Verifica se saiu da pÃ¡gina de login E tem elementos do portal
- Considera falha se fica 5s+ na pÃ¡gina de login
- Detecta mensagens de erro
- Rejeita senhas incorretas corretamente

**Edge Cases Identificados:**
- âœ… SessÃ£o ativa prÃ©via no Jacad ("vocÃª jÃ¡ estÃ¡ logado")
- â³ Timeout de rede/conexÃ£o lenta
- â³ MudanÃ§as na estrutura HTML do Jacad

---

## ğŸ¨ Interface e UX

### Tela 1 - Home (Login):
- Logo ETEP centralizado
- Campos: CPF (com mÃ¡scara) + Senha
- BotÃ£o "Entrar" com validaÃ§Ã£o
- Loading spinner durante autenticaÃ§Ã£o
- VersÃ£o do app (dinÃ¢mica via version.json)

### Tela 2 - Menu:
- Logo pequeno + tÃ­tulo "Portal ETEP"
- BotÃµes: Portal do Aluno (ativo), outros (desabilitados)
- BotÃ£o "Sair" (logout + volta para Home)

### Tela 3 - Portal:
- InAppBrowser com barra branca personalizada
- BotÃµes azuis (#252e62) + "Voltar" customizado
- Auto-login transparente para o usuÃ¡rio

**Design System:**
- Cores: Branco + Azul ETEP (#252e62)
- Font: Open Sans (Google Fonts)
- Responsive design para mÃºltiplos tamanhos
- AnimaÃ§Ãµes CSS suaves

---

## ğŸ“± ConfiguraÃ§Ã£o Nativa

### Android (config.xml):
- Package: com.etep.portal
- Ãcone: icon.png (mÃºltiplas densidades)
- Splash screen branco com logo
- PermissÃµes: Internet, Network State
- Target SDK: Android API 34+

### Plugins Cordova:
- cordova-plugin-inappbrowser: WebViews customizadas
- cordova-plugin-device: Info do dispositivo

---

## ğŸ—‚ï¸ Gerenciamento de Estado

### ETEPApp (index.js):
```javascript
class ETEPApp {
  constructor()           // InicializaÃ§Ã£o
  init()                 // Setup listeners + versÃ£o
  handleLoginSubmit()    // Fluxo de login
  navigateToPortal()     // Abertura do portal
  handleLogout()         // Limpeza + volta ao inÃ­cio
  showLoading()          // UI feedback
}
```

### Dados Persistidos:
- **localStorage**: CPF (para auto-preenchimento)
- **MemÃ³ria**: Credenciais validadas (temporÃ¡rio)
- **SessÃ£o**: Estado de autenticaÃ§Ã£o ativo

---

## ğŸš€ Build e Deploy

### Comandos Principais:
```bash
# Desenvolvimento
cordova platform add android
cordova build android
cordova run android

# Release
cordova build android --release
```

### Versionamento:
- version.json como single source of truth
- Git tags para releases
- Commits semÃ¢nticos com co-author Claude

---

## ğŸ”„ Fluxos de UsuÃ¡rio

### Primeiro Acesso:
1. Abre app â†’ Tela Home
2. Digita CPF/senha â†’ Loading
3. Sistema valida no Jacad (oculto)
4. Sucesso â†’ Menu
5. Clica Portal â†’ InAppBrowser com auto-login

### Acessos Seguintes:
1. CPF auto-preenchido (localStorage)
2. UsuÃ¡rio sÃ³ digita senha
3. Mesma validaÃ§Ã£o + navegaÃ§Ã£o

### Logout:
1. Clica "Sair" no Menu
2. Limpa credenciais + CPF
3. Volta para Home (campos vazios)

---

## ğŸ› Troubleshooting

### Problemas Conhecidos:
- **Gradle wrapper**: Resolvido com install manual
- **Java version**: Exige JDK 17 LTS
- **CRLF warnings**: CosmÃ©tico (Windows/Git)
- **SessÃ£o Jacad ativa**: Edge case identificado

### Logs Importantes:
- Browser console para validaÃ§Ã£o
- Cordova device logs
- Git commit history preservado

---

## ğŸ“‹ Roadmap Futuro

### V2 Planejado:
- [ ] Backend prÃ³prio para autenticaÃ§Ã£o
- [ ] Comprovante de MatrÃ­cula ativo
- [ ] Link de Pagamento ativo  
- [ ] Push notifications
- [ ] Offline mode avanÃ§ado
- [ ] Google Play Store release

### Melhorias TÃ©cnicas:
- [ ] Testes automatizados
- [ ] CI/CD pipeline
- [ ] Monitoramento de erros
- [ ] Analytics de uso
- [ ] DetecÃ§Ã£o de mudanÃ§as no Jacad

---

## ğŸ‘¥ Equipe e Handoff

**Desenvolvido por**: Claude Code + Sergio (ETEP)
**RepositÃ³rio**: https://github.com/sergioetepead/appAluno.git
**Branch principal**: master
**Ãšltima versÃ£o estÃ¡vel**: v1.4.3

**Para continuidade**:
- Clone do repo + npm install
- Android SDK configurado
- Credenciais de teste do Jacad
- Acesso ao GitHub do projeto

**Contato tÃ©cnico**: 
- Issues no GitHub
- DocumentaÃ§Ã£o no prÃ³prio cÃ³digo
- Commits descritivos para contexto